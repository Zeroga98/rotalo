<div class="info-container">
  <div class="tittle main-title">
    <h1 (click)="openModalDelete()" class="text ">Productos tienda</h1>
  </div>

  <div id="flashMessage" class="flashMessage">
    <div *ngIf="messageChange && !errorChange" class="alert alert-success text--center" role="success">
      <p>
        <span class="icon-check alert-icon"></span> {{messageChange}}</p>
    </div>
    <div *ngIf="errorChange && !messageChange" class="alert alert-danger" role="alert">
      <ul>
        <li>
          <span>{{errorChange}}</span>
        </li>
      </ul>
    </div>
  </div>

  <div class="navbar-header">
      <mat-tab-group #tabs (selectedTabChange)="tabChanged($event)" class="tab-table">
          <mat-tab label="Activos">
          </mat-tab>
          <mat-tab label="Inactivos"></mat-tab>
        </mat-tab-group>

        <div id="upload-offer-shop" class="flexbox center-center centrado upload-shop">
            <div class="container-offer">
              <a (click)="goToUploadProduct()" class="upload-offer-button">
                <div class="outside-circle">
                  <div class="inside-circle">
                    <span></span>
                  </div>
                  <label class="">Subir producto</label>
                </div>
              </a>
            </div>
          </div>
  </div>


  <div *ngIf="productos && productos.length > 0" class="tabla-campaign">
      <table id="campaigns-wrap" class="campaigns">
        <tr>
          <th>Foto</th>
          <th>ID</th>
          <th>Título</th>
          <th>Descripción</th>
          <th>Precio</th>
          <th>Precio + IVA</th>
          <th>IVA</th>
          <th>Fecha de publicación</th>
          <th>Unidades</th>
          <th *ngIf="statusTab == 0">Inactivar</th>
          <th *ngIf="statusTab == 1">Activar</th>
          <th class="table-no-border"></th>
        </tr>
        <tbody #grid [sortablejs]="productos" [sortablejsOptions]="{ animation: 150 }" id="grid"
        class="grid">
            <tr id = {{product.id}}  *ngFor="let product of  productos">
                <td>
                  <img *ngIf="product.photos" [src]="product.photos.url" alt="user.name">
                </td>
                <td>
                  {{product.id}}
                </td>
                <td>
                  {{product.name}}
                </td>
                <td>
                  <p class="description">
                    {{product.description}}
                  </p>
                </td>
                <td>
                  {{calculateIVA(product.price) | currency:'$' | removeDigits}}
                </td>
                <td>
                  {{product.price | currency:'$' | removeDigits}}
                </td>
                <td>
                  19%
                </td>
                <td>
                  {{getFormatDate(product['publishedAt'])}}
                </td>
                <td>
                  {{product.stock}}
                </td>
                <td>
                    <div class="switch-container">
                        <input #status type="checkbox"
                        [checked]="product.status == 'active' ? true : false"
                        id="id-name--{{product.id}}" name="state" class="switch-input"
                        (change)="saveCheck(status, product.id)">
                        <label for="id-name--{{product.id}}" class="switch-label"></label>
                    </div>
                </td>
                <td>
                    <button mat-icon-button [matMenuTriggerFor]="menu" aria-label="Example icon-button with a menu">
                        <mat-icon>more_vert</mat-icon>
                      </button>
                      <mat-menu #menu="matMenu">
                        <button [routerLink]="getUrlPreviewProduct(product.id)" mat-menu-item>
                          <div class="icon preview"></div>
                          Vista previa
                        </button>
                        <button [routerLink]="getUrlProduct(product.id)" mat-menu-item>
                          <div class="icon edit"></div>
                          <span>Editar</span>
                        </button>
                        <button (click)="openModalDelete(product.id)" mat-menu-item>
                          <div class="icon delete"></div>
                          <span>Eliminar</span>
                        </button>
                      </mat-menu>
                </td>
            </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="productos && productos.length > 0 && statusTab == 0" class="button-container">
      <a (click) = "onSubmit()" class="btn-red" mat-button>Guardar cambios</a>
      <a (click) = "goBack()" class="btn-white" mat-button>Cancelar</a>
   </div>
</div>
