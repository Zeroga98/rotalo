<div class="md-overlay"></div>
<!--  <div class="md-overlay-red"></div>-->

<modal-shareProduct class="md-modal-center md-effect-1" id="custom-modal-2"></modal-shareProduct>
<!-- <modal-ticket [coupon] = "couponService" class="md-modal-center md-effect-1 md-modal-coupon" id="custom-modal-3"></modal-ticket> -->

<subcategory-filter *ngIf="!showBanner || configFiltersSubcategory" [config]="configFiltersSubcategory" [country]="countrySelected"
  (onFilterBySellType)="filteBySellType($event)" (onFilterBySort)="filterBySort($event)" (onFilterByCity)="filterByCity($event)"
  (onFilterByState)="filterByState($event)"></subcategory-filter>

<ngx-carousel class="carousel-theme desktop" *ngIf="showBanner && !configFiltersSubcategory" [inputs]="carouselConfig">
  <ngx-item NgxCarouselItem *ngFor="let image of imagesBanner">
    <div class="item-banner">
      <a target="_blank" *ngIf="image['link']" [href]="image['link']">
          <img [src]="image['url-photo-desktop']">
      </a>
      <img *ngIf="!image['link']" [src]="image['url-photo-desktop']">
    </div>
  </ngx-item>

  <span NgxCarouselPrev class="arrow-container left">
    <span class="gtmBannerRotFlechas arrow arrow-prev">
    </span>
  </span>
  <span NgxCarouselNext class="arrow-container right">
    <span class="gtmBannerRotFlechas arrow arrow-next">
    </span>
  </span>

</ngx-carousel>

<ngx-carousel class="carousel-theme mobile" *ngIf="showBanner && !configFiltersSubcategory" [inputs]="carouselConfig">
  <ngx-item NgxCarouselItem *ngFor="let image of imagesBanner">
    <div class="item-banner">
        <a target="_blank" *ngIf="image['link']" [href]="image['link']">
            <img [src]="image['url-photo-mobile']">
        </a>
        <img *ngIf="!image['link']" [src]="image['url-photo-mobile']">
    </div>
  </ngx-item>
  <span NgxCarouselPrev class="gtmBannerRotFlechas arrow arrow-prev">
  </span>
  <span NgxCarouselNext class="gtmBannerRotFlechas arrow arrow-next">
  </span>
</ngx-carousel>

<div *ngIf="featuredproducts.length != 0 && showBanner && !configFiltersSubcategory" class="featured-products featured-section">
  <div class="featured-container">
    <div class="row-featured">
      <div class="header-featured">
        <img class="star-img" src="../../assets/img/estrella.gif" alt="estrella">
        <h3>Artículos destacados</h3>
      </div>
      <ngx-carousel class="carousel-featured" *ngIf="featuredproducts.length != 0" [inputs]="carouselProductsConfig">
        <ngx-item NgxCarouselItem *ngFor="let featuredproduct of featuredproducts">
          <a class="link-product" *ngIf="featuredproduct" onclick="return false;" [href]="getUrlProduct(featuredproduct)">
            <div class="carousel-container">
              <div class="featured-cards">
                <div class="featured-card">
                  <div class="item__wrapper">

                    <div class="item__card">
                      <a onclick="return false;" [href]="getUrlProduct(featuredproduct)">
                        <div class="item__image-container">
                          <div [ngClass]="isPromoDate && idCountry != 9? 'container-black-friday' : ''" *ngIf="featuredproduct['is-low-price'] || isPromoDate&&isActivePromo(featuredproduct)"
                            class="container-low-price">
                            <p *ngIf="!isPromoDate && idCountry == 1 || idCountry == 9">$ REBAJÓ</p>
                          </div>
                          <div *ngIf="featuredproduct['featuredType'] == 'mostVisits'" class="container-trending">
                            <p>TRENDING</p>
                          </div>
                          <img (click)="selectProductSuperUser(featuredproduct, $event)" *ngIf="!featuredproduct.photos" [src]="defaultImage"
                            [alt]="featuredproduct.name" (error)="updateSrc($event)">
                          <img (click)="selectProductSuperUser(featuredproduct, $event)" *ngIf="featuredproduct.photos" [src]="featuredproduct.photos?.url || featuredproduct.photos[0].url"
                            [alt]="featuredproduct.name" (error)="updateSrc($event)">
                          <div (click)="shareProduct('custom-modal-2' , featuredproduct)" class="gtmCompartirProducto icon-share-container">
                            <div class="gtmCompartirProducto icon-share">
                            </div>
                          </div>
                        </div>
                      </a>
                      <a onclick="return false;" [href]="getUrlProduct(featuredproduct)">
                        <div (click)="selectProductSuperUser(featuredproduct , $event)" class="item__content">
                          <div class="item__name">
                            <span>
                              {{featuredproduct.name}}
                            </span>
                          </div>
                          <div class="item__price-block">
                            <div class="price-container">
                              <div>
                                <span *ngIf=" featuredproduct.price != 0 && featuredproduct.currency == 'GTQ'">
                                  {{featuredproduct.price | currency:"Q" | removeDigits}}
                                </span>
                                <span *ngIf=" featuredproduct.price != 0 && featuredproduct.currency != 'GTQ' && idCountry == 9">
                                  {{featuredproduct.price | currency:"$" | removeDigits}}
                                </span>
                                <span *ngIf=" featuredproduct.price != 0 && featuredproduct.currency != 'GTQ' && idCountry != 9">
                                  {{featuredproduct.price | currency:"$" | removeDigits}}
                                </span>
                                <span *ngIf=" featuredproduct.price == 0">Gratis</span>
                              </div>
                              <div [ngClass]="featuredproduct['previousPrice'] && featuredproduct['previousPrice'] >  featuredproduct['price'] || isActivePromo(featuredproduct)? 'low-price' : ''"
                                *ngIf="featuredproduct['previousPrice'] && isPromoDateBefore && isActivePromo(featuredproduct) || featuredproduct['previousPrice'] && featuredproduct['previousPrice'] >  featuredproduct['price']">
                                <span *ngIf="featuredproduct['previousPrice'] != 0 && featuredproduct.currency == 'GTQ'" class="name">{{featuredproduct['previousPrice']
                                  | currency:"Q" | removeDigits}}</span>
                                <span *ngIf="featuredproduct['previousPrice'] != 0 && featuredproduct.currency != 'GTQ' && idCountry == 9"
                                  class="name">{{featuredproduct['previousPrice']
                                  | currency:"$" | removeDigits}}</span>
                                <span *ngIf="featuredproduct['previousPrice'] != 0 && featuredproduct.currency != 'GTQ' && idCountry == 1"
                                  class="name">{{featuredproduct['previousPrice']
                                  | currency:"$" | removeDigits}}</span>
                              </div>
                            </div>
                          </div>

                          <div class="item__location">
                            <span class="icon-location"></span>
                            <span>{{getLocation(featuredproduct)}}</span>
                          </div>
                          <div *ngIf="featuredproduct.user" class="item_info-user">
                            <div class="icon-container" [ngStyle]="{'background-color':featuredproduct.user.company.colour}">
                              <span class="icon-account" *ngIf="!featuredproduct.user.photo && !featuredproduct.user.photos"></span>
                              <img *ngIf="featuredproduct.user.photo" [src]="featuredproduct.user.photo.url">
                              <img *ngIf="featuredproduct.user.photos" [src]="featuredproduct.user.photos.url">
                            </div>
                            <div class="info-user">
                              <p class="name-text">{{featuredproduct.user.name}}</p>
                              <p *ngIf="featuredproduct.user && featuredproduct.user.company" [ngStyle]="{'color':featuredproduct.user.company.colour}"
                                class="company-text">
                                {{featuredproduct.user?.company.name}}
                                <span class="comunidad-text"> - {{featuredproduct.user?.company.community.name}}</span>
                              </p>
                            </div>
                          </div>
                        </div>
                      </a>
                    </div>

                  </div>
                </div>
              </div>
            </div>
          </a>
        </ngx-item>
        <span NgxCarouselPrev class="carousel-arrow carousel-arrow__prev">
          <span class="icon icon-chevron-thin-left"></span>
        </span>
        <span NgxCarouselNext class="carousel-arrow carousel-arrow__next">
          <span class="icon icon-chevron-thin-right"></span>
        </span>
      </ngx-carousel>
    </div>
  </div>
</div>



<div *ngIf="showBannerToShop && showBanner && !configFiltersSubcategory" class="featured-section bancolombia-site">
  <div class="featured-container">
    <div class="header-featured">
      <h3>
        Conoce la tienda Bancolombia
      </h3>
    </div>
    <img class="desktop" (click)="goToBancolombiaShop()" src="../../assets/img/banner/img_banner_tienda.jpg" alt="micrositio bancolombia">
    <img class="mobile" (click)="goToBancolombiaShop()" src="../../assets/img/banner/mobile/banner_mobile.png" alt="micrositio bancolombia">
  </div>
</div>


<carousel-product [products] = "featuredproducts" ></carousel-product>

<div>
  <div class="container-spinner" *ngIf="isSpinnerShow">
    <custom-spinner></custom-spinner>
  </div>
  <div class="msg-no-products" *ngIf="showAnyProductsMessage">
    ¡Aún no tenemos productos en esta categoría! Por favor busca nuevamente.
  </div>
  <div [ngStyle]="{'min-height':showAnyProductsMessage ? '0' : '480px' }" class="container-masonry">
    <div class="list">
      <div class="masonry">
        <div class="grid-item">
          <product #productsEnd *ngFor="let product of products | paginate: { itemsPerPage: 24, currentPage: pageNumber, totalItems: totalPages }"
            class="product-feed" [ngClass]="product && product.product_status === 'sell_process' ? 'deactivated-photo' : ''"
            [isProductSelling]="false" [showField]="true" [product]="product" (selected)="selectProduct($event); setScroll($event)"
            [colourCompany]="product['seller_company_color']  ? product['seller_company_color'] : '#FF3646'" id="{{product.product_id}}">
          </product>
        </div>
      </div>
      <pagination-controls *ngIf="showPagination" class="has-text-centered" responsive="true" previousLabel="Anterior"
        nextLabel="Siguiente" (pageChange)="getPage($event)">
      </pagination-controls>
    </div>
  </div>
</div>
<custom-footer></custom-footer>
