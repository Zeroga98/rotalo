<div (click) = "openSearch()"  [ngClass]="showSearchMobile ?  'show ': '' " class="md-overlay-promo"></div>
<nav>
  <div class="container">
    <div class="navbar-header material-design form-theme">
      <div class="divisor-left">
        <back-arrow class="white" *ngIf="!hideBackArrow"></back-arrow>
        <a class="gtmLogoRotalo navbar-brand" (click)="goToHome()">
          <img class="gtmLogoRotalo" src="./assets/img/logo-red.svg" alt="brand">
          <h1 class="sr-only">rótalo</h1>
        </a>
        <div class="search-container desktop">
            <form (ngSubmit)="onSubmitSearch()">
                <input
                [matAutocomplete]="auto" [formControl]="queryField" class="form-control" type="text" name="search">
                <button class="button-search" type="submit">
                  <div class="search-icon">
                  </div>
                </button>
              </form>
              <mat-autocomplete #auto="matAutocomplete">
                <mat-option (click) = "goToCategory(suggestion)" *ngFor="let suggestion of suggestList" [value]="suggestion.suggestion">
                    <span class="suggestion">{{suggestion.suggestion}}</span>
                  </mat-option>
              </mat-autocomplete>
        </div>
      </div>
      <div class="divisor-right">
        <ul class="list-options">
          <li class="desktop">
            <a class="gtmCategorias categories" #closeMenu (click)="openCategories($event)">
              <span>
                Categorías
              </span>
            </a>
          </li>

          <li class="desktop">
              <a class="categories" (click)="loadNotifications()" [matMenuTriggerFor]="perfilMenu">
                <span>
                  ¡Hola <span *ngIf="userName">{{userName}}!</span>
                </span>
              </a>
              <mat-menu backdropClass="sg-vertical-sub-menu-user" xPosition="before" #perfilMenu="matMenu">
                <div class="menu-usuario">
                  <div *ngIf="userEdit" class="info">
                    <div class="photo-container">
                      <div [routerLink]="profileShow" class="photo clickable">
                        <img *ngIf="!userEdit.photo || !userEdit.photo.url" [src]="defaultImage" alt="no imagen">
                        <img *ngIf="userEdit.photo && userEdit.photo.url" [src]="userEdit.photo.url" alt="imagen-perfil">
                      </div>
                      <div class="user-info">
                        <p *ngIf="userName" class="name">{{userName}}</p>
                        <p *ngIf="userEdit.company && userEdit.company.name" class="company">{{userEdit.company.name}}</p>
                        <div  *ngIf="userEdit.calificacionGeneral" class="ranking">
                            <span class="star star-full">
                            </span>
                            <span> {{userEdit.calificacionGeneral}}
                            </span>
                        </div>
                      </div>
                    </div>
                  </div>
                  <button routerLinkActive="active" [routerLink]="message" mat-menu-item>Mensajes</button>
                  <button routerLinkActive="active" [routerLink]="sold" mat-menu-item>Mis artículos rotados</button>
                  <button routerLinkActive="active" [routerLink]="selling" mat-menu-item>Mis artículos rotando</button>
                  <button routerLinkActive="active" [routerLink]="edit" mat-menu-item>Mis datos</button>
                  <button routerLinkActive="active" [routerLink]="security" mat-menu-item>Seguridad</button>
                  <button routerLinkActive="active" [routerLink]="notificationsSettings" mat-menu-item>Configuraciones</button>
                  <button *ngIf="isSuperUser()" routerLinkActive="active" [routerLink]="featuredProduct" mat-menu-item>Destacados</button>
                  <button *ngIf="isSuperUser()" routerLinkActive="active" [routerLink]="adminRegister" mat-menu-item>Pre-registro</button>
                  <button *ngIf="isSuperUser()" routerLinkActive="active" [routerLink]="adminOrders" mat-menu-item>Órdenes tienda</button>
                  <button *ngIf="isSuperUser()" routerLinkActive="active" [routerLink]="campaign" mat-menu-item>Campañas</button>
                  <button *ngIf="isSuperUser()" routerLinkActive="active" [routerLink]="banners" mat-menu-item>Banners home</button>
                  <button (click) = "onLogout()" mat-menu-item>Cerrar sesión</button>
                </div>
              </mat-menu>
          </li>

          <li *ngIf="isBancolombiaShop" (click)="goToShoppingCar()" class="car-container cart-active">
            <div [ngClass]="{active: isActive(rotaloCart)}" class="container-car">
              <span class="icon-shopping-car">
              </span>
              <p>Carrito</p>
              <span *ngIf="isBancolombiaShop && cartAvailable" class="noti-circle">{{totalCart}}</span>
            </div>
          </li>

          <li  (click) = "openSearch()" class="mobile-search bell-container">
              <div class="container-bell">
                <span class="search-icon-dark">
                </span>
              </div>
          </li>

          <li (click)="goToNotifications();" class="mobile-notification bell-container">
            <div class="container-bell">
              <span [ngClass]="notificationsUnread > 0 ?  'active': '' " class="icon-bell">
              </span>
            </div>
          </li>

          <li class="desktop-notification bell-container">
            <div (click)="loadNotifications()" [matMenuTriggerFor]="appMenu" class="container-bell">
              <span [ngClass]="notificationsUnread > 0 ?  'active': '' " class="icon-bell">
              </span>
            </div>
            <mat-menu backdropClass="sg-vertical-sub-menu"  class="profile-menu" xPosition="before" #appMenu="matMenu">
              <notifications-component (click)="$event.stopPropagation();"></notifications-component>
            </mat-menu>
          </li>

          <li class="mobile-notification menu-container">
              <div *ngIf="!hideMenuIcon()" [routerLink]="menu" class="menu">
                <span>
                </span>
              </div>
              <div *ngIf="hideMenuIcon()" (click) = "goBack()" class="menu">
                  <span class="close">
                  </span>
                </div>
          </li>

        </ul>
        <div  id="upload-offer" class="flexbox center-center">
          <div [ngClass]="isBancolombiaShop?  'disabled': '' " class="container-offer">
            <a (click)="initScrollProduct(); goToUploadProduct()" class="upload-offer-button">
              <div class="gtmSubeTuOferta outside-circle">
                <div class="gtmSubeTuOferta inside-circle">
                  <span>+</span>
                </div>
                <label class="gtmSubeTuOferta">Subir oferta</label>
              </div>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="back-categories" (click)="_closeMenu()" id="back-categories"></div>
  <categories-menu #categoriesMenu (categorySelected)="selectedCategory($event)" (subCategorySelected)="selectedSubCategory($event)"
    (closeMenu)="_closeMenu()"></categories-menu>

  <div class="search" [ngClass]="showSearchMobile ?  'show ': '' ">
    <div class="search-container-mobile" >
        <div (click) = "openSearch()" class="back-arrow"></div>
        <form class="form-theme" (ngSubmit)="onSubmitSearch()">
            <input
            placeholder="¿Qué estás buscando?"
            [matAutocomplete]="auto" [formControl]="queryField" class="form-control" type="text" name="search">
            <button class="button-search" type="submit">
              <div class="search-icon-dark">
              </div>
            </button>
          </form>
          <mat-autocomplete #auto="matAutocomplete">
            <mat-option (click) = "goToCategory(suggestion); showSearchMobile = false" *ngFor="let suggestion of suggestList" [value]="suggestion.suggestion">
                <span
                class="suggestion">{{suggestion.suggestion}}</span>
              </mat-option>
          </mat-autocomplete>
    </div>
  </div>
</nav>
